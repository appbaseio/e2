{
    "data": {
        "markdownRemark": {
            "html": "<h1 id=\"array-datatype\"><a href=\"#array-datatype\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Array Datatype</h1>\n<p>This article is a part of the series on <a href=\"https://appbaseio.gitbooks.io/esc/content/tagwise-search/introduction.html\"><strong>How to build tag wise search with Elasticsearch</strong></a>.</p>\n<h2 id=\"how-to-store-data-using-elasticsearch-arrays\"><a href=\"#how-to-store-data-using-elasticsearch-arrays\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to store data using Elasticsearch arrays</h2>\n<p>A major use-case of tags in apps is to associate a content with one or more labels, it is then but natural that a tagwise search feature should be able to retrieve the marching content by user specifying either just one or more than one tag labels. A tag wise search is also fundamentally different from a full-text search as here, we are finding an exact match of a tag with a content item.</p>\n<p>In this post, we will be using an Array datastructure to store labels with a content document. For making the exact lookups, we will be applying  a term query on the dataset.</p>\n<p>In Elasticsearch, there is no dedicated array type. Any field can contain zero or more values by default, however, all values in the array must be of the same datatype. If you create a new field by indexing an array, Elasticsearch will use the datatype of the first value in the array to determine the type of the new field. We can create array of strings, integers, objects or array of arrays to store the data.</p>\n<p>Elasticsearch can also supports empty array or null array values.</p>\n<p>Default array does not support quering each object independently of the other objects in the array. To distinguish objects stored in array from each other we need to use <strong>Nested datatype</strong>.</p>\n<p><code>Note:</code> Read more about nested datatype over <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/nested.html\">here</a>.</p>\n<h2 id=\"defining-mappings\"><a href=\"#defining-mappings\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defining Mappings</h2>\n<p>If you have worked with a SQL database system before, you are probably familiar with the idea of a schema. Elasticsearch’s equivalent of a schema definition is a mapping.</p>\n<p>There is no special mapping required for arrays. You can store multiple values with single field without predefining schema.</p>\n<h2 id=\"indexing-data\"><a href=\"#indexing-data\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Indexing Data</h2>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>curl -XPUT $host/tagwise/search/1 -d '{\n  \"repo\" : \"reddit\",\n  \"tags\" : [ \"javascript\", \"python\", \"reddit\" ],\n  \"owner\" : \"reddit\",\n  \"url\" : \"https://github.com/reddit/reddit\",\n  \"stars\" : 13053,\n  \"language\" : \"Python\",\n  \"created-on\" : \"2008-06-18T23:30:53Z\"\n}'</code></pre>\n      </div>\n<p>Here document is indexed under the <code>tagwise</code> index and <code>search</code> type.</p>\n<p>If we look back at our data mappings, they should now look like as follows</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>curl $host/tagwise/_mapping?pretty</code></pre>\n      </div>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>{\n  \"tagwise\": {\n    \"mappings\": {\n      \"search\": {\n        \"properties\": {\n          \"owner\": {\n            \"type\": \"string\"\n          },\n          \"repo\": {\n            \"type\": \"string\"\n          },\n          \"tags\": {\n            \"type\": \"string\"\n          },\n          \"url\": {\n            \"type\": \"string\"\n          },\n          \"stars\": {\n            \"type\": \"integer\"\n          },\n          \"language\": {\n            \"type\": \"string\"\n          },\n          \"created-on\": {\n            \"type\": \"date\"\n          }\n        }\n      }\n    }\n  }\n}</code></pre>\n      </div>\n<p>Elasticsearch created these mappings dynamically based on our indexed data.</p>\n<h2 id=\"data-browser-view\"><a href=\"#data-browser-view\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Data Browser View</h2>\n<p>For accessibility, we have indexed ~300 data points of Github repos that can be viewed in the data browser <a href=\"https://opensource.appbase.io/dejavu/live/#?input_state=XQAAAALsAAAAAAAAAAA9iIqnY-B2BnTZGEQz6wkFsfg8zEltX1Bae4VtdAEIGYBD3zva4XDAUUA9VTrYdZNLQd5JP0mLm4u5-Ie7D8qYvlBkqiI3yZnvcuRZPoM5wmYJTyyh-A3d-80gPrA7-YAOP1CjsElJ1Awvm7iOoQzYFWoNbFMzMRnLSrmyJf08HGhNiv-TDi-0N2SLrJ-iOAm2-0MLNsYdDFMc7va07VB2QiT6uDBzg3MVoV7a7L6bsXj06jwjF8DI8BFy4lYZ1Rkf_9VL4AA\">here. <img src=\"http://i.imgur.com/x7nLB9s.png\"></a></p>\n<h2 id=\"query\"><a href=\"#query\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Query</h2>\n<p>Elasticsearch array supports <strong>match</strong> as well as <strong>term</strong> query. Let’s write our first search query for the arrays.</p>\n<p>Syntax for <strong>term</strong> query -</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>curl $host/tagwise/search/_search?pretty -d '{\n  \"query\": {\n    \"term\": {\n      \"tags\": \"reddit\"\n    }\n  }\n}'</code></pre>\n      </div>\n<p>Syntax for <strong>match</strong> query -</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>curl $host/tagwise/search/_search?pretty -d '{\n  \"query\": {\n    \"match\": {\n      \"tags\": \"reddit\"\n    }\n  }\n}'</code></pre>\n      </div>\n<h3 id=\"response\"><a href=\"#response\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Response:</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"gatsby-code-jsxon\"><code>{\n  \"took\" : 14,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 6.1179934,\n    \"hits\" : [ {\n      \"_index\" : \"tagwise\",\n      \"_type\" : \"search\",\n      \"_id\" : \"AVvR1yM3gPzdwFFNDvs7\",\n      \"_score\" : 6.1179934,\n      \"_source\" : {\n        \"repo\" : \"reddit\",\n        \"tags\" : [ \"javascript\", \"python\", \"reddit\" ],\n        \"owner\" : \"reddit\",\n        \"url\" : \"https://github.com/reddit/reddit\",\n        \"stars\" : 13053,\n        \"language\" : \"Python\",\n        \"created-on\" : \"2008-06-18T23:30:53Z\"\n      }\n    } ]\n  }\n}</code></pre>\n      </div>\n<p>You can also try out this query interactively  <a href=\"https://opensource.appbase.io/mirage/#?input_state=XQAAAAIqBQAAAAAAAAA9iIhnNAWbsswtYjeQNZkpzQK4_mOzUeDpWmHCrDFs7iDKutPu_ClxcjCYOqUqELVPJ0G6sKj4u2r8c-T_5P6GlG49XYgfc2GYuMMRuSumifCxuSSCXtOAxs6Hde1p2VgSpnD3tfQtwbKtmlUV9FWFj1xXnSypOS15FxHENksJUxXCtYmd4iVjGL1bowAxrWfOuw1nuIcWHek4srAs1sTP0SOd6XPS6-blE0WjAQt4ce9B23dy_19xYCecMoWthMwrwWTFypBAO8Vcd9w4VuVo1KU8LBRzuRLhDL0KvF_VG62ehVISj4Ty-MiHt6Wpb2oKqBeU0_RAvNWfU1QZMs-TXvpXEXsEaIoh-foBQR6mza5cKEG3-8vZnMLBXW2J5sjEUeM7tqfjdgcDJCjC3ICatsg2wVEme8RVF3cFkkDDX0MTi9_t1eIrq8yU3AHAMZqvAUb5mkmRVWPKetqsE-i4GQyerYVnSY-EJXAPnnip8IXLbYRM8d4ocCXD3R20C7ZwGFGG0MuPIwmzwrf6hStk8ddjvTn81vDwIPDnr91ov42AvY0-7Kb5CpGG6dF2kFR7xcKxyVCxYfbE8Wl2f0RTH6jk-GS7HuqFdz4MEIWS63yeqQ-jajHPetrQP81BisYnXF281pV7ajxzqx8kkTagiyRT9mQsOR_oMVCT63LKNBeCSnffodl6mf_7Qo1M\">here. <img src=\"http://i.imgur.com/9bg2TMJ.png\"></a></p>\n<p>You should next read about <a href=\"https://appbaseio.gitbooks.io/esc/content/tagwise-search/exact-match.html\"><strong>exact match</strong></a>.</p>",
            "frontmatter": {
                "title": "",
                "next": null,
                "prev": null,
                "nextTitle": null,
                "prevTitle": null
            },
            "fields": {
                "path": "docs/tagwise-search/arrays.md",
                "slug": "/docs/tagwise-search/arrays.html"
            }
        }
    },
    "pathContext": {
        "slug": "/docs/tagwise-search/arrays.html"
    }
}